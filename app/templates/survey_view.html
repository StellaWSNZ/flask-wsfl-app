{% extends "header.html" %} {% block title %}WSFL Self Review Survey{% endblock
%} {% block content %}
<div class="container my-5">
  <h1 class="mb-4 text-center text-primary">{{title}} (Submitted)</h1>

  <div class="d-flex justify-content-center">
    <div
      class="alert alert-secondary d-inline-block px-4 py-3"
      style="max-width: 1200px"
    >
      <strong>Name:</strong> {{ fullname or 'Unknown' }} |
      <strong>Email:</strong> {{ email }} | <strong>Role:</strong> {{ role or
      'Unknown' }} | <strong>Entity:</strong> {{ entity or 'Unknown' }} |
      <strong>Submitted:</strong> {{ submitted.strftime('%d %B %Y, %I:%M %p') }}
    </div>
  </div>
  <form>
    {% for question in questions %}
    <fieldset class="mb-4 p-4 border rounded bg-white shadow-sm">
      <legend class="h6">
        <strong>Q{{ question.id }}:</strong> {{ question.text }}
      </legend>

      {% if question.type == 'LIK' %} {% for pos, label in question.labels %}
      <div class="form-check">
        <input class="form-check-input" type="radio" name="q{{ question.id }}"
        id="q{{ question.id }}_{{ pos }}" value="{{ pos }}" {% if
        question.answer_likert == pos %} checked {% endif %} disabled />
        <label class="form-check-label" for="q{{ question.id }}_{{ pos }}">
          {{ label }}
        </label>
      </div>
      {% endfor %} {% elif question.type == 'DDL' %} {# current answer: text +
      optional resolved option id #} {% set ans_txt = question.answer_text %} {%
      set ans_id = question.answer_option_id %}

      <select class="form-select" disabled>
        {% if question.options %} {# Render all options and select the matching
        one #} {% for opt in question.options %} {% set label = opt.OptionLabel
        or opt.label or opt.Description %} {% set value = opt.OptionValue or
        opt.value %} {% set match_id = (ans_id is not none and opt.OptionID ==
        ans_id) %} {% set match_txt = ans_txt and ( (label and label|trim|lower
        == ans_txt|trim|lower) or (value and value|trim|lower ==
        ans_txt|trim|lower) ) %}
        <option
          value="{{ opt.OptionID }}"
          {%
          if
          match_id
          or
          match_txt
          %}selected{%
          endif
          %}
        >
          {{ label or value or '—' }}
        </option>
        {% endfor %} {% else %} {# No options available? Show the current answer
        as the lone choice #}
        <option selected>{{ ans_txt or '—' }}</option>
        {% endif %}
      </select>

      {% elif question.type == 'TEXT' %}
      <input
        type="text"
        class="form-control mt-2"
        name="q{{ question.id }}"
        id="q{{ question.id }}"
        value="{{ question.answer_text }}"
        disabled
      />
      {% elif question.type == 'SHT' %}
      <input
        type="text"
        class="form-control mt-2"
        name="q{{ question.id }}"
        id="q{{ question.id }}"
        value="{{ question.answer_text }}"
        disabled
      />
      {% elif question.type == 'LNG' %}
      <textarea
        class="form-control mt-2"
        rows="4"
        name="q{{ question.id }}"
        id="q{{ question.id }}"
        disabled
      >
{{ question.answer_text }}</textarea
      >
      {% elif question.type == 'T/F' %}
      <div class="form-check">
        <input class="form-check-input" type="radio" name="q{{ question.id }}"
        value="1" id="q{{ question.id }}_yes" {% if question.answer_tf_value ==
        1 %}checked{% endif %} disabled>
        <label class="form-check-label" for="q{{ question.id }}_yes">Yes</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="q{{ question.id }}"
        value="0" id="q{{ question.id }}_no" {% if question.answer_tf_value == 0
        %}checked{% endif %} disabled>
        <label class="form-check-label" for="q{{ question.id }}_no">No</label>
      </div>
      {% if question.answer_tf_value is none %}
      <div class="text-muted small">No answer</div>
      {% endif %} {% endif %}
    </fieldset>
    {% endfor %}
  </form>
</div>

{% endblock %}
